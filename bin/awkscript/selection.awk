#!/bin/awk -f
# This script gives a fasta reference file with correct header

# Run this on a tab delimited selection file where the sixth
# column is selector sequence and ammend the result to a fasta
# file generated by  download2fasta.pl on the ampregion in this folder.

# Takes the two parameters r (read length) and mm (missmatches)
# [write selection -v mm=x r=y] as well as a selection file.
# Using >> [filename of the reference fasta file] makes
# a complete Mosaik reference file.

BEGIN { FS="\t"; }
{
  if(substr($1,0,1)!="#") {
  	
	l=$4-r+mm+2;
	junction=r-mm-4;
	a=substr($5,0,junction); 
	b=substr($5,length($5)-r+mm+2,junction); 
	
	print ">" $1 "#" $2 "#" l "#" $3 "#" junction "\n" b a;
  }
}
